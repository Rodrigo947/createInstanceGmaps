var MultiGeometryCoordinates = "-43.17223358,-21.75965309 -43.16924667,-21.76898766 -43.17616272,-21.77689743 -43.17166519,-21.78674507 -43.17699051,-21.78654671 -43.17764282,-21.79437065 -43.17438889,-21.7987709 -43.16933441,-21.79725075 -43.16713333,-21.80147362 -43.16252899,-21.8015995 -43.16286469,-21.80925369 -43.15516663,-21.80815697 -43.14763641,-21.81322861 -43.1556015,-21.8181591 -43.15854263,-21.82907486 -43.17461014,-21.84542465 -43.18933105,-21.8552227 -43.19996643,-21.84376526 -43.2093277,-21.84204483 -43.21251678,-21.84712219 -43.22386169,-21.84693718 -43.22735596,-21.8574295 -43.23748779,-21.86221504 -43.24360657,-21.85166168 -43.24900055,-21.84992981 -43.2449379,-21.84637833 -43.24324799,-21.83516884 -43.24820709,-21.83501434 -43.25247192,-21.82847786 -43.27471161,-21.83936501 -43.27910614,-21.83308983 -43.2776413,-21.82795715 -43.28233719,-21.82290077 -43.29405594,-21.82508659 -43.29977036,-21.82001305 -43.30868912,-21.8263073 -43.31723785,-21.8231144 -43.31974792,-21.82185364 -43.32538605,-21.81990051 -43.33226776,-21.81070137 -43.34196854,-21.81140137 -43.3482132,-21.81933594 -43.35921478,-21.82165337 -43.36655426,-21.82279968 -43.36697388,-21.82849693 -43.37227249,-21.82493782 -43.37672043,-21.82658005 -43.37688828,-21.83455467 -43.38588715,-21.83539009 -43.3849411,-21.84187317 -43.39066696,-21.84627724 -43.3944664,-21.85865211 -43.38558197,-21.86522865 -43.38515854,-21.87668037 -43.37494278,-21.88918114 -43.37513733,-21.89654732 -43.40707779,-21.87786865 -43.41160202,-21.88031197 -43.41073608,-21.88980293 -43.41882706,-21.89435005 -43.41989517,-21.8884697 -43.42735672,-21.8826828 -43.4247551,-21.87715149 -43.41750336,-21.87672615 -43.42031097,-21.86301041 -43.41292572,-21.85960388 -43.41670609,-21.85543633 -43.42227173,-21.85848427 -43.43235397,-21.85938835 -43.43719482,-21.85671616 -43.44430161,-21.85970688 -43.44216156,-21.8768692 -43.45488739,-21.87260818 -43.46115494,-21.87467766 -43.45738602,-21.88816261 -43.46591568,-21.88368416 -43.47516251,-21.89169121 -43.47664261,-21.88163567 -43.48083115,-21.87981033 -43.48600006,-21.88388634 -43.49219894,-21.88066292 -43.49891281,-21.88166237 -43.49172592,-21.88798714 -43.4956398,-21.89236259 -43.49547195,-21.9047184 -43.4923172,-21.90253067 -43.48875046,-21.9057579 -43.49669266,-21.91583252 -43.4952774,-21.93322182 -43.49097061,-21.93610191 -43.50045013,-21.93987656 -43.50310516,-21.9461441 -43.5070076,-21.9448967 -43.52147675,-21.95723343 -43.53209305,-21.9607048 -43.54300308,-21.96981812 -43.54547882,-21.97612953 -43.55241394,-21.97676277 -43.57297897,-21.99287796 -43.57736206,-21.99146843 -43.58106232,-21.99944687 -43.58591843,-21.99958992 -43.59056854,-21.99321175 -43.58937073,-21.98544693 -43.59628677,-21.9788475 -43.5774765,-21.96415138 -43.57974243,-21.95426559 -43.59348297,-21.94186401 -43.59815216,-21.93274689 -43.59988785,-21.92378807 -43.61225128,-21.90537071 -43.61838531,-21.90404892 -43.63005447,-21.91015625 -43.63600159,-21.90759087 -43.64267731,-21.91098785 -43.65228271,-21.9064312 -43.65244293,-21.89493942 -43.63869858,-21.89229393 -43.63823318,-21.88500214 -43.6451683,-21.8690033 -43.65784073,-21.86655235 -43.65859222,-21.86143875 -43.66654205,-21.85357094 -43.66231155,-21.8450222 -43.65350342,-21.84089279 -43.65288544,-21.83473015 -43.64719772,-21.83003616 -43.64169693,-21.83012009 -43.64169693,-21.82224274 -43.63613892,-21.81803131 -43.63098145,-21.81878662 -43.63850403,-21.80194855 -43.63691711,-21.79646492 -43.65301514,-21.78912163 -43.65100098,-21.78052711 -43.65486145,-21.76843071 -43.66823578,-21.75097466 -43.66850281,-21.74313164 -43.66583633,-21.74238586 -43.66891861,-21.73753166 -43.66061783,-21.73402977 -43.66064453,-21.72340012 -43.66472244,-21.72591972 -43.67150497,-21.72415924 -43.67881012,-21.71291733 -43.67898941,-21.71225739 -43.6787796,-21.71240997 -43.68153,-21.70289612 -43.67814255,-21.69885254 -43.6827507,-21.69426727 -43.67047882,-21.6710968 -43.67508316,-21.66412926 -43.68540192,-21.66163826 -43.68028259,-21.65401268 -43.68612671,-21.64470482 -43.68505859,-21.62865829 -43.67880249,-21.62460136 -43.67366409,-21.61241531 -43.66556931,-21.60527611 -43.65666199,-21.59755707 -43.640522,-21.60862732 -43.63561249,-21.61356354 -43.62128067,-21.61472321 -43.61883163,-21.61903191 -43.62084198,-21.62673378 -43.61184311,-21.64073372 -43.60652924,-21.63307953 -43.60181046,-21.63322258 -43.59705734,-21.61506653 -43.57872772,-21.61803627 -43.57261658,-21.61276245 -43.56727982,-21.61663437 -43.55350113,-21.6164341 -43.54208755,-21.62074661 -43.53828049,-21.61063957 -43.52938843,-21.60327721 -43.52758026,-21.59222031 -43.51648712,-21.58853149 -43.51138687,-21.55995178 -43.50244141,-21.56129265 -43.50114059,-21.55685806 -43.49422073,-21.55647278 -43.49386597,-21.5559063 -43.49699783,-21.55155945 -43.490448,-21.54890633 -43.49738693,-21.54136086 -43.49125671,-21.53715324 -43.49652863,-21.53350258 -43.49305344,-21.53128624 -43.48280716,-21.53543472 -43.47776413,-21.54367065 -43.47377777,-21.54160309 -43.47320557,-21.53130913 -43.4508934,-21.52096367 -43.44977951,-21.52412415 -43.43947983,-21.52505112 -43.4375,-21.5372963 -43.43211746,-21.54009628 -43.42721939,-21.5412674 -43.4196701,-21.53142357 -43.4098587,-21.53838921 -43.40238953,-21.53700256 -43.39863586,-21.54467392 -43.38747025,-21.54462242 -43.38893509,-21.55196571 -43.38644028,-21.55821228 -43.38213348,-21.55905914 -43.37733459,-21.55799484 -43.36124039,-21.5870533 -43.35155869,-21.59625435 -43.35771179,-21.60361862 -43.35460281,-21.61282158 -43.34855652,-21.61829376 -43.35770798,-21.62082863 -43.35997772,-21.62696075 -43.35575485,-21.63691711 -43.33591461,-21.64486885 -43.34013367,-21.65234184 -43.33269119,-21.65628433 -43.32822418,-21.65663528 -43.32550049,-21.66303635 -43.31652069,-21.6632328 -43.30705261,-21.65681267 -43.30329132,-21.65416145 -43.29573822,-21.6616993 -43.2901001,-21.66960144 -43.28004074,-21.68655014 -43.25986099,-21.68114471 -43.26644516,-21.69855881 -43.26552582,-21.71032143 -43.259552,-21.71686363 -43.26294327,-21.72267914 -43.25811005,-21.74246025 -43.26357651,-21.74501228 -43.26192474,-21.74874687 -43.25823975,-21.75524902 -43.25209427,-21.75169182 -43.24341202,-21.75093842 -43.24109268,-21.75415611 -43.24038696,-21.75918579 -43.24655533,-21.76154327 -43.2473793,-21.76878738 -43.24449158,-21.7702713 -43.23169327,-21.76212502 -43.22052383,-21.76066589 -43.20909882,-21.74856567 -43.18819427,-21.7435112 -43.17672348,-21.75600433 -43.17223358,-21.75965309"
var map;

//Retorna um array de coordenadas no mesmo formato usado pelo google maps
function buildCoordinatesArrayFromString(MultiGeometryCoordinates){
    var finalData = [];
    var grouped = MultiGeometryCoordinates.split(" ");

    grouped.forEach(function(item, i){
        let a = item.trim().split(',');

        finalData.push({
            lat: parseFloat(a[1]),
            lng: parseFloat(a[0])
            
        });
    });
    console.log(finalData[0])
    return finalData;
}

//retorna o maior numero e menor valor de latitude e longitude
function minMaxLatLong(bounds){
    var minMax = {
        min: {lat: 0, lng: 0},
        max: {lat: -100, lng: -100}
    }
        
    for(var i=0;i<bounds.length;i++){
        
        if(minMax.min.lat>bounds[i].lat) minMax.min.lat = bounds[i].lat;
        if(minMax.min.lng>bounds[i].lng) minMax.min.lng = bounds[i].lng;

        if(minMax.max.lat<bounds[i].lat) minMax.max.lat = bounds[i].lat;
        if(minMax.max.lng<bounds[i].lng) minMax.max.lng = bounds[i].lng;
    }

    return minMax;
}

function randomizarLatLong(polygon,quant,minMax){
    var pontos = [];
    var latitude,longitude;
    for(var i=0;i<quant;i++){
        
        latitude = Math.random() * (minMax.max.lat - minMax.min.lat) + minMax.min.lat;
        longitude = Math.random() *  (minMax.max.lng - minMax.min.lng) + minMax.min.lng;
        var point =  new google.maps.LatLng(latitude, longitude);
        
        while(!google.maps.geometry.poly.containsLocation(point,polygon)){
            latitude = Math.random() * (minMax.max.lat - minMax.min.lat) + minMax.min.lat;
            longitude = Math.random() *  (minMax.max.lng - minMax.min.lng) + minMax.min.lng;
            point = new google.maps.LatLng(latitude, longitude);
        }


        pontos.push({lat:latitude,lng:longitude});
    }
   
    return pontos;
}


function initMap() {
    
    map = new google.maps.Map(document.getElementById('map'), {
        zoom: 13,
        center: {lat: -21.7642, lng: -43.3496} 
    });
    var JFBounds = buildCoordinatesArrayFromString(MultiGeometryCoordinates);
      
    var JFPolygon = new google.maps.Polygon({
        path: JFBounds,
        strokeColor: '#FF0000',
        strokeOpacity: 1.0,
        strokeWeight: 2,
        fillOpacity: 0
    });
    JFPolygon.setMap(map);
    
    var minMax = minMaxLatLong(JFBounds);
    var pontos = randomizarLatLong(JFPolygon,200,minMax);
    
    for(var i=0;i<pontos.length;i++){
    radiusRandom = Math.floor(Math.random() * (1000 - 1 + 1)) + 1;
    var cityCircle = new google.maps.Circle({
        strokeColor: '#0000FF',
        strokeOpacity: 0.8,
        strokeWeight: 2,
        fillColor: '#0000FF',
        fillOpacity: 0.35,
        map: map,
        center: pontos[i],
        radius: radiusRandom
        });

    }
    teste();
    
}


function teste(){
    $.getJSON('https://nominatim.openstreetmap.org/search.php?q=Manoel+Honorio+juiz+de+fora&polygon_geojson=1&format=json', function(data){
        console.log(data[0].geojson.coordinates[0])
        var conversao = [];


        data[0].geojson.coordinates[0].forEach(function(item, i){
            conversao.push({
                lat: parseFloat(item[1]),
                lng: parseFloat(item[0])
                
            });
        });
        
        var polygon = new google.maps.Polygon({
            path: conversao,
            strokeColor: '#FF0000',
            strokeOpacity: 1.0,
            strokeWeight: 2,
            fillOpacity: 0
        });
        polygon.setMap(map);
        
    })
   
}





